from "hashes/keccak/256bit" import main as kecca256;
def hashPair(u8[32] a, u8[32] b)-> u8[32] {
	u8[64] c = [
		...a,
		...b
	];
	return kecca256(c);
}

def main(u8[2][32] a, u32 addr, u8[32] c) -> u8[32] {
	u32 mut path = addr >> 5;
	u8[32] mut node = a[0];

	for u32 i in 1 .. 2 {
		node = (path & 1) == 0 ? hashPair(node, a[i]) :
							   hashPair(a[i], node);
		path = path >> 1;
	}

	log("x is {}, y is {}", node, c);

	assert(node == c);
    return node;
}